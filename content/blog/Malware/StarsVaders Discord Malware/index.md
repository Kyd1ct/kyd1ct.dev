---
title: StarsVaders or Spyware? A Discord Malware Disguised as a Game
date: 2024-10-24
draft: false
author: Kyd1ct
description: A static and dynamic analysis of a data exfiltration malware.
---

Recently, a fake game called StarsVaders started circulating on Discord. Similar to other malware on that platform, it aims to trick users into downloading malware instead of an actual game. This malware's real goal is to steal information like browser history, tokens, and other personal data.

In this article, we’ll break down how StarsVaders works, including:

- Static Analysis: Looking at the file properties and hidden details that reveal it’s not a real game.

- Dynamic Analysis: Running StarsVaders in a test environment to see what it tries to do on the system.

Along the way, we’ll use tools like FlareVM, VirusTotal, and Hybrid Analysis to help us uncover the true nature of this fake game.

By the end, you’ll see how attackers hide malware in plain sight—and how to spot it.

## Discovery
The phishing link was obtained through a friend, who mentioned it in discord server. The messages were sent by a friend of theirs but they seemed suspicious. I asked them for the link and started with the analysis.

![Initial Discovery](/img/StarsVaders/discover.jpg)

I first checked the website in [VirusTotal](https://www.virustotal.com/gui/domain/www.starsvaders.com) and [URLScan](https://urlscan.io/result/2d44f588-dfa1-4cf6-88af-29493e0b0a88/) and saw that the it was marked as malicious by a few vendors. The domain was created a month ago, which indicated suspicious activity.

When I opened the website on my VM, I noticed a large "Download" button on top of the page. It also had various screenshots of the alleged game. I looked into this and identified that they used images from a game called [The Braves](https://store.steampowered.com/app/2479830/The_Braves/) while the malware was attempting to impersonate an upcoming game called [StarVaders](https://store.steampowered.com/app/2097570/StarVaders/).

The previously mentioned "Download" button utilised Discord's CDN to host and spread the malicious file. The attackers used this as it looks benign due to gamers being very familiar with Discord. This also makes it easier for the adversary as they do not need to spin up any extra infrastructure to spread the files.

![Download](/img/StarsVaders/download_link.jpg)

As of checking again today (5th November) the file is inaccessible.

![Rar](/img/StarsVaders/rar.jpg)

## Analysis
### Static Analysis

After downloading the archive, I opened it and found an executable within it. I attempted to extract it, but the archive required a password to complete the extraction. I would assume the attackers provided the password to the victims. I had no such luck as my friend did not fall for the phishing attempt.

![Password](/img/StarsVaders/password.jpg)

I decided to use John The Ripper's module called zip2john which is used for password protected zip files. Thankfully, the password was within the rockyou.txt password dictionary file. The password was revealed to be `beta`.

I used FLOSS to extract strings from the file in order to obtain an initial understanding of its capabilities. FLOSS is a great too for such tasks as it can identify obfuscation and attempt to make it human-readable. In this case, since the file was too big, FLOSS essentially worked as the Linux binary `strings`. Observing the output indicated that the file is capable of manipulating the user's `Clipboard` and `Registries`. 

![Floss](/img/StarsVaders/floss.jpg)

Running the installer dropped multiple other binaries. FLOSS showed similar results on the other files.

### Dynamic Analysis
As mentioned, the installer dropped more binaries. The files were dropped in the following directories:  
- AppData\Local\starsvaders-updater
- AppData\Local\Programs\StarsVaders

The former directory contained one file which was named `installer.exe`. The file was identical to the initial installer `StarsVaders Setup 2.0.0.exe` which would indicate attempts at persistence. I, however, could not identify any indicators of persistence within the registries and/or scheduled tasks.

The other location featured more files:
- StarsVaders.exe - main executable.
- Ininstall StarsVaders.exe - alleged uninstaller.
- Chrome/Chromium-related files.
- Electron-related files.
- elevate.exe - within the `resources` directory.
![Main Files](/img/StarsVaders/main_files.jpg)

The main executable, `StarsVaders.exe`, contained the main functionality of the malware. It attempted to steal data from the user's browser (cookies, history, etc.).
![Theft](/img/StarsVaders/theft.jpg)

It also attempted to establish persistence by creating files within the Discord directories within AppData. The file covered all versions of Discord (Discord, Canary, PTB, Development) and even the custom version of the application called BetterDiscord.
![Persistence](/img/StarsVaders/persistence.jpg)

The uninstaller removed the files from the main directory but the installer within `AppData\Local\starsvaders-updater` remained. It is possible that the files potential files within the Discord directories would run the installer whenever Discord is booted.

The final file of interest, `elevate.exe`, is a file used by Electron applications. It does what the name suggests - it elevates the application's privileges, providing it with higher access to the OS. 

Finally, I decided to test how the application exfiltrates the obtained data. I did this by running `inetsim` and `wireshark` on a Linux VM and placing both VMs on the same Host-Only network adapter. The malware did not appear to download any additional payloads but it made a connection to a URL called `unity-api[.]net`. 
![Exfiltration](/img/StarsVaders/exfiltration.jpg)

While this URL might look benign, `VirusTotal` and `who.is` indicated that it was created on the 31st of August. It would highly unlikely that Unity are hosting their API on a nearly brand-new domain.

###  After the Analysis
After the analysis was concluded, I gathered all of the evidence and reported the URLs to the providers which were used to host the websites/servers.

## IoCs

### Links
www.starsvaders[.]com - [VirusTotal](https://www.virustotal.com/gui/domain/www.starsvaders.com)  
unity-api[.]net - [VirusTotal](https://www.virustotal.com/gui/domain/unity-api.net)  

### Hashes
`StarsVaders Setup 2.0.0.exe`
ea2b7e73659c251243f33999c5b0e12bf6c180f44ff545a02acb7164eda8cd83
`StarsVaders.exe`  
4d05d719f2af8bcb4e706d7b01ed54739fc63dd20579b17ef34c78e9a2e57a6e
`StarsVaders.rar`  
9532a0f831316fd17b4089afc87950c472ab8ed5b58e0b2765d1d4fe8557557e
`Uninstall StarsVaders.exe`  
47b6d08004a15d0bc8ac07f1a03d487cf287203e71024d438b2f503017ef8e6a
`elevate.exe`  
9b1fbf0c11c520ae714af8aa9af12cfd48503eedecd7398d8992ee94d1b4dc37
`installer.exe` 
ea2b7e73659c251243f33999c5b0e12bf6c180f44ff545a02acb7164eda8cd83  