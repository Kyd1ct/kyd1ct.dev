
[{"content":"This section contains all my blog articles!\n","date":"24 October 2024","externalUrl":null,"permalink":"/blog/","section":"Blog","summary":"","title":"Blog","type":"blog"},{"content":"BSides STPete24 CTF Challenge Creation\n","date":"24 October 2024","externalUrl":null,"permalink":"/blog/ctf/stpete24-ctf/","section":"Blog","summary":"","title":"BSides STPete24 CTF Challenge Creation","type":"blog"},{"content":"This section contains all my CTF articles!\n","date":"24 October 2024","externalUrl":null,"permalink":"/blog/ctf/","section":"Blog","summary":"","title":"CTFs","type":"blog"},{"content":"Welcome to my website! I will use this website as a blog to document my research and analysis into various malware samples and how they affect systems. The papers I will include in the blog pages will contain thorough analysis of the samples and a forensic investigation into the effects it has on the affected machines.\nI have also included links to my accounts on various platforms such as LinkedIn, Github, and TryHackMe!\n- Kyd1ct\n","date":"24 October 2024","externalUrl":null,"permalink":"/","section":"kyd1ct.dev","summary":"","title":"kyd1ct.dev","type":"page"},{"content":"This section contains all my malware analysis articles!\n","date":"24 October 2024","externalUrl":null,"permalink":"/blog/malware/","section":"Blog","summary":"","title":"Malware Analysis","type":"blog"},{"content":"Recently, a fake game called StarsVaders started circulating on Discord. Similar to other malware on that platform, it aims to trick users into downloading malware instead of an actual game. This malware\u0026rsquo;s real goal is to steal information like browser history, tokens, and other personal data.\nIn this article, we’ll break down how StarsVaders works, including:\nStatic Analysis: Looking at the file properties and hidden details that reveal it’s not a real game.\nDynamic Analysis: Running StarsVaders in a test environment to see what it tries to do on the system.\nAlong the way, we’ll use tools like FlareVM, VirusTotal, and Hybrid Analysis to help us uncover the true nature of this fake game.\nBy the end, you’ll see how attackers hide malware in plain sight—and how to spot it.\nDiscovery #\rThe phishing link was obtained through a friend, who mentioned it in discord server. The messages were sent by a friend of theirs but they seemed suspicious. I asked them for the link and started with the analysis.\nI first checked the website in VirusTotal and URLScan and saw that the it was marked as malicious by a few vendors. The domain was created a month ago, which indicated suspicious activity.\nWhen I opened the website on my VM, I noticed a large \u0026ldquo;Download\u0026rdquo; button on top of the page. It also had various screenshots of the alleged game. I looked into this and identified that they used images from a game called The Braves while the malware was attempting to impersonate an upcoming game called StarVaders.\nThe previously mentioned \u0026ldquo;Download\u0026rdquo; button utilised Discord\u0026rsquo;s CDN to host and spread the malicious file. The attackers used this as it looks benign due to gamers being very familiar with Discord. This also makes it easier for the adversary as they do not need to spin up any extra infrastructure to spread the files.\nAs of checking again today (5th November) the file is inaccessible.\nAnalysis #\rStatic Analysis #\rAfter downloading the archive, I opened it and found an executable within it. I attempted to extract it, but the archive required a password to complete the extraction. I would assume the attackers provided the password to the victims. I had no such luck as my friend did not fall for the phishing attempt.\nI decided to use John The Ripper\u0026rsquo;s module called zip2john which is used for password protected zip files. Thankfully, the password was within the rockyou.txt password dictionary file. The password was revealed to be beta.\nI used FLOSS to extract strings from the file in order to obtain an initial understanding of its capabilities. FLOSS is a great too for such tasks as it can identify obfuscation and attempt to make it human-readable. In this case, since the file was too big, FLOSS essentially worked as the Linux binary strings. Observing the output indicated that the file is capable of manipulating the user\u0026rsquo;s Clipboard and Registries.\nRunning the installer dropped multiple other binaries. FLOSS showed similar results on the other files.\nDynamic Analysis #\rAs mentioned, the installer dropped more binaries. The files were dropped in the following directories:\nAppData\\Local\\starsvaders-updater AppData\\Local\\Programs\\StarsVaders The former directory contained one file which was named installer.exe. The file was identical to the initial installer StarsVaders Setup 2.0.0.exe which would indicate attempts at persistence. I, however, could not identify any indicators of persistence within the registries and/or scheduled tasks.\nThe other location featured more files:\nStarsVaders.exe - main executable. Ininstall StarsVaders.exe - alleged uninstaller. Chrome/Chromium-related files. Electron-related files. elevate.exe - within the resources directory. The main executable, StarsVaders.exe, contained the main functionality of the malware. It attempted to steal data from the user\u0026rsquo;s browser (cookies, history, etc.). It also attempted to establish persistence by creating files within the Discord directories within AppData. The file covered all versions of Discord (Discord, Canary, PTB, Development) and even the custom version of the application called BetterDiscord. The uninstaller removed the files from the main directory but the installer within AppData\\Local\\starsvaders-updater remained. It is possible that the files potential files within the Discord directories would run the installer whenever Discord is booted.\nThe final file of interest, elevate.exe, is a file used by Electron applications. It does what the name suggests - it elevates the application\u0026rsquo;s privileges, providing it with higher access to the OS.\nFinally, I decided to test how the application exfiltrates the obtained data. I did this by running inetsim and wireshark on a Linux VM and placing both VMs on the same Host-Only network adapter. The malware did not appear to download any additional payloads but it made a connection to a URL called unity-api[.]net. While this URL might look benign, VirusTotal and who.is indicated that it was created on the 31st of August. It would highly unlikely that Unity are hosting their API on a nearly brand-new domain.\nAfter the Analysis #\rAfter the analysis was concluded, I gathered all of the evidence and reported the URLs to the providers which were used to host the websites/servers.\nIoCs #\rLinks #\rwww.starsvaders[.]com - VirusTotal\nunity-api[.]net - VirusTotal\nHashes #\rStarsVaders Setup 2.0.0.exe ea2b7e73659c251243f33999c5b0e12bf6c180f44ff545a02acb7164eda8cd83 StarsVaders.exe\n4d05d719f2af8bcb4e706d7b01ed54739fc63dd20579b17ef34c78e9a2e57a6e StarsVaders.rar\n9532a0f831316fd17b4089afc87950c472ab8ed5b58e0b2765d1d4fe8557557e Uninstall StarsVaders.exe\n47b6d08004a15d0bc8ac07f1a03d487cf287203e71024d438b2f503017ef8e6a elevate.exe\n9b1fbf0c11c520ae714af8aa9af12cfd48503eedecd7398d8992ee94d1b4dc37 installer.exe ea2b7e73659c251243f33999c5b0e12bf6c180f44ff545a02acb7164eda8cd83\n","date":"24 October 2024","externalUrl":null,"permalink":"/blog/malware/starsvaders-discord-malware/","section":"Blog","summary":"","title":"StarsVaders or Spyware? A Discord Malware Disguised as a Game","type":"blog"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"}]